<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
  <title>Twitter Analysis</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
</head>
<body>
<h1>Twitter Sentiment Analysis</h1>

<p>
<b>Due</b>:  at 6pm on Tuesday, December 4.
  Submit via email, and use a subject line [datasci250][assignment5]
</p>

<p>
Twitter represents a fundamentally new instrument to make social measurements.  Millions of people voluntarily express opinions across any topic imaginable --- this data source is incredibly valuable for both research
and business.
</p>
<p>
For example, researchers have shown that 
the &quot;mood&quot; of communication on twitter
<a href="http://www.nytimes.com/2011/09/30/science/30twitter.html">reflects biological rhythms</a> and can even used to <a href="http://arxiv.org/pdf/1010.3003&amp;embedded=true">predict the stock market</a>.  A student here at UW used geocoded tweets to <a href="http://cliffmass.blogspot.com/2012/07/thunderstorm-fest.html">plot a map of locations where &quot;thunder&quot; was mentioned in the context of a storm system in Summer 2012.</a>
</p>
<p>
Researchers from Northeastern University and Harvard University studying the characteristics and dynamics of Twitter <a href="http://www.ccs.neu.edu/home/amislove/twittermood/">have an excellent resource</a> for learning more about this area.
</p>

<p>
In this assignment, you will 
</p>
<ul>
<li> Access the twitter Application Programming Interface using python.</li>
<li> Estimate the public's perception (the sentiment) of a particular term or phrase.</li>
<li> Analyze the relationship between location and mood based on a sample of twitter data.</li>
</ul>

<p>This assignment is open-ended in several ways.  You'll need to make some decisions about how best to solve the problem. </p>

<p style="color:blue">It is perfectly acceptable to discuss your solution on the forum, but don't share code.</p>
<p style="color:blue">You may work in groups if you prefer.  When you turn in the assignment, cc your group members.</p>



<h3 id="twitter">The Twitter Application Programming Interface</h3>

<p>
Twitter provides a very rich REST API for querying the system, accessing data, and control your account
</p>
<p>
You can <a href="https://dev.twitter.com/docs">read more about the Twitter API</a>.
</p>

<!--
<br>
https://dev.twitter.com/docs/streaming-apis
<br>
https://dev.twitter.com/docs/api/1/get/statuses/sample
<br>
-->

<h3>Python environment</h3>
<p>
This assignment assumes you have a basic familiarity with Python and a functioning Python environment.
</p>
</p>
If you need help setting up a python environment, post a mesage to the forum and the instructor or one of your classmates will respond.
</p>
<p>
If you need help with getting up to speed with Python, send the instructor an email.
</p>

<h3 id="unicode">Unicode strings</h3>

<p>
Strings in the twitter data prefixed with the letter "u" are unicode strings.  For example:
</p>
<pre>
u"This is a string"
</pre>
<p>
Unicode is a standard for representing a much larger variety of characters beyond the roman alphabet (greek, russian, mathmatical symbols, logograms from non-phonetic writing systems such as kanji, etc.)
</p>
<p>
In most circumstances, you will be able to use a unicode object just like a string.
</p>
<p>
If you encounter an error involving unicode, you can use the <code>encode</code> method to just replace the international characters, like this:
</p>
<pre>
a=u"aaaàçççñññ"
a.encode('ascii','replace')
'aaa???????'
</pre>

<h2 id="querytwitter">Problem 1: Query Twitter with Python</h2>
<p>
First, download and unzip the file <a href="homework6.zip">homework6.zip</a>.
</p>

<p>
Use the urllib and json libraries in python to access the basic twitter search API and return JSON data.  The url is:
</p>
<pre>
http://search.twitter.com/search.json?q=microsoft
</pre>

<p>
The format of the result is <i>JSON</i>, which stands for JavaScript Object Notation. It is a simple format for representing nested structures of data --- lists of lists of dictionaries of lists of .... you get the idea.
</p>

<p>
As you might imagine, it is fairly straightforward to convert JSON data into a Python data structure.
Indeed, there is a convenient library to do so, called <code>json</code>, which we will use.
</p>

<p>
Twitter provides only <a href="https://dev.twitter.com/docs/platform-objects/tweets">partial documentation for understanding this data format.</a> 
But it's not difficult to deduce the structure.
</p>

<p>
The response is a dictionary representing the entire resultset.  The "results" key corresponds holds the actual tweets; each tweet is another dictionary.  Write a program to print out the text of every tweet.
</p>


<p style="color:red">
What to turn in: Report the number of tweets returned by this query.
</p>

<h2 id="pages">Problem 1: Get all pages of results</h2>

<p>Generalize your program to fetch 10 pages of results.  Note that you can return a different page of results by passing an additional argument in the url:
<pre>
http://search.twitter.com/search.json?q=microsoft&amp;page=2
</pre>

<p>
What to turn in: Nothing.
</p>


<h2 id="read_scores">Problem 2: Compute the sentiment</h2>

<p>
The file AFINN-111.txt contains a list of sentiment scores.  Each line in the file contains a word or phrase followed by a score.  See the file AFINN-README.txt for more information.
</p>

<p>
Write a function that takes a tweet and returns a sentiment score using AFINN-111.txt.  You may want to consider how to avoid possible biases resulting from long tweets, term frequency, or other details, but this is not necessary.  If you implement such details, explain them breifly in your submission.
</p>

<p>Python hint that you may or may not need in your solution: If you want to concatenate a whole list of strings by a delimiter, you can use the join method of a string.  Note that you call join as a method of the delimiter you wish to use, not as a method of the list you wish to concatenate.</p>

<pre>
>>> ",".join(["separated", "by", "commas"]
"separated,by,commas"
>>> "".join(["a","b","c"])
"abc"
>>> " ".join(["a","b","c"])
"a b c"
</pre>

<p style="color:red">
What to turn in: Explain your calculation in 1-2 sentences and report the score for the term "microsoft."
</p>

<h2 id="location">Problem 3: Access the live stream</h2>

<p style="color:blue">
To access the live stream, you will need to install the <a href="http://pypi.python.org/pypi/oauth2/">oauth2 library</a> so you can properly authenticate.
</p>


The steps below will help you set up your twitter account to be able to access the live 1% stream.

<ul>
<li>Create a twitter account if you do not already have one.</li>
<li>Go to https://dev.twitter.com/apps and log in with your twitter credentials.</li>
<li>Click "create an application"</li>
<li>Fill out the form and agree to the terms.  Put in a dummy website if you don't have one you want to use.</li>
<li>On the next page, scroll down and click "Create my access token"</li>
<li>Copy your "Consumer key" and your "Consumer secret" into twitterstream.py</li>
<li>Click "Create my access token."  You can <a href="https://dev.twitter.com/docs/auth">Read more about Oauth authorization.</a></li>
<li>Open twitterstream.py and set the variables corresponding to the consumer key, consumer secret, access token, and access secret</li>
<li>Run the following and make sure you see data flowing.</li>
<pre>
$ python twitterstream.py
</pre>
You can pipe the output to a file, wait a few seconds, then kill it to generate a sample.
</li>
<li>
Modify twitterstream.py to run until you collect 1000 tweets then stop.  (You can use sys.exit() to stop the program)
</li>

</ul>

<p style="color:red">
What to turn in: Time your program and estimate how many tweets per second are being submitted overall (assuming this is a 1% sample.)
</p>

<h2 id="location">Problem 4: Which State is happiest?</h2>

<p>
Using the live stream, try to deduce the state from which each tweet was submitted. Some tweets are geotagged, and you can use this. There are other ways that may be simpler but perhaps less accurate.  Anything is fine, but document and defend your assumptions.
</p>

<p>The live stream has a slightly different format from the response to the query you have been using.  In this file, each line is a Tweet object, as <a href="https://dev.twitter.com/docs/platform-objects/tweets">described in the twitter documentation</a>.
</p>

<p>Note: Not every tweet dictionary will have a text key -- real data is dirty.  Be prepared to debug, and feel free to throw out tweets that your code can't handle to get something working.
</p>

<p>
The file <code>saturday_afternoon.json</code> contains a 5-minute sample of about 1% of the complete twitter stream, which may be useful during testing.
</p>

<p style="color:red">
What to turn in: Describe and defend your method of determining location in 1-2 sentences, and report the happiest and saddest state.  Test your analysis against the live stream on at least a 5-minute sample.  
</p>


<h2 id="mood">Problem 5: Mood vs. Time</h2>

<p>
Run your analysis for 24 hours and plot mood vs. hour for the entire feed.  You can generate text files and use Excel, or you can use a visualization tool such as matplotlib.  (Note that matplotlib has some idiosyncrasies -- I can't promise to help you troubleshoot.)
</p>
<p>
Optional: Make an additional 3 plots filtering the tweets from California, Florida, and New York.
</p>


<p style="color:red">What to turn in:  Turn in all the timeseries plots you made.
</p>

<h2 id="mood">Problem 6 (Optional): Do something interesting with the Twitter feed!</h2>

<p>Some not-very-creative ideas:</p>
<ul>
<li>Create a little web app that continuously computes the sentiment of a given search term.  Plot this as a timeseries.</li>
<li>Try to estimate the "velocity" of twitter.  How how long does it take for a tweet to be retweeted?  A retweet contains an embedded Tweet object within the "retweeted_status" attribute.  See <a href="https://dev.twitter.com/docs/platform-objects/tweets">the documentation</a></li>
<li>Analyze word frequency in the stream.  What are the most common words?  (You will want to find a list of stopwords online and filter them out.)</li>
</ul>

<p style="color:red">What to turn in:  A brief explanation of your analysis, and any accompanying figure or data.
</p>



</body>
</html>

